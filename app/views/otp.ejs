<%- include('includes/head.ejs') %>
<style>
    body{
        background-color: #ebecf0;
    }
    .otp-letter-input{
        max-width: 99%;
        height: 90px;
        border: 1px solid #0064e8;
        border-radius:10px;
        color: #0064e8;
        font-size: 60px;
        text-align: center;
        font-weight: bold;
    }
    .btn{
        height: 50px;
    }
</style>
<body  class="back">
    <div class="container p-5">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6 mt-5">
                <div class="bg-white p-5 rounded-3 shadow-sm border">
                    <div>
                        <p class="text-center text-black" style="font-size: 5.5rem;"><i class="fa-solid fa-envelope-circle-check"></i></p>
                        <p class="text-center text-center h5 ">Please check your email</p>
                        <p class="text-muted text-center">We've sent a code to <b><%= session.userid %></b></p>
                        <form action="/panel/verify_login_otp" method="post" autocomplete="off">
                            <input type="hidden" name="_csrf" value="<%=csrfToken%>" />
                            <input name="email" type="hidden" value="<%= session.userid %>">
                            <div class="row pt-4 pb-2">
                                <div class="col-2">
                                    <input name="otp1" class="otp-letter-input" type="text" maxlength="1" required>
                                </div>
                                <div class="col-2">
                                    <input name="otp2" class="otp-letter-input" type="text" maxlength="1" required>
                                </div>
                                <div class="col-2">
                                    <input name="otp3" class="otp-letter-input" type="text" maxlength="1" required>
                                </div>
                                <div class="col-2">
                                    <input name="otp4" class="otp-letter-input" type="text" maxlength="1" required>
                                </div>
                                <div class="col-2">
                                    <input name="otp5" class="otp-letter-input" type="text" maxlength="1" required>
                                </div>
                                <div class="col-2">
                                    <input name="otp6" class="otp-letter-input" type="text" maxlength="1" required>
                                </div>
                            </div>                           
                    <p class="text-muted text-center">Didn't get the code? <a href="#" class="text-primary">Click to resend.</a></p>
                
                <div class="row pt-5">
                    <!-- <div class="col-6">
                        <button class="btn btn-outline-secondary w-100">Cancel</button>
                    </div> -->
                <div class="col-12">
                    <button class="btn btn-dark w-100">Verify</button>
                </div>
            </form>
                            
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
$(document).ready(function() {
    $('.otp-letter-input').on('input', function() {
        var $this = $(this);
        var value = $this.val();

        // Only allow numeric input
        if (!/^\d$/.test(value)) {
            $this.val('');
            return;
        }

        // Move to next input if current input is not empty and it's not the last input
        var nextInput = $this.parent().next().find('.otp-letter-input');
        if (value && nextInput.length) {
            nextInput.focus();
        }
    });

    $('.otp-letter-input').on('keydown', function(e) {
        var $this = $(this);

        // Move to previous input if current input is empty and backspace is pressed
        if (e.key === 'Backspace' && !$this.val()) {
            var prevInput = $this.parent().prev().find('.otp-letter-input');
            if (prevInput.length) {
                prevInput.focus();
            }
        }
    });

    $('.otp-letter-input').on('paste', function(e) {
        e.preventDefault();
        var pasteData = (e.originalEvent || e).clipboardData.getData('text');
        var digits = pasteData.replace(/\D/g, ''); // Remove non-digit characters

        var $inputs = $('.otp-letter-input');
        $.each(digits.split(''), function(i, char) {
            if (i < $inputs.length) {
                $($inputs[i]).val(char);
                if (i < $inputs.length - 1) {
                    $($inputs[i + 1]).focus();
                }
            }
        });
    });
});
</script>
